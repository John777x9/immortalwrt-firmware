#!/bin/bash
# ============================================
# CMCC RAX3000M — eMMC 64GB
# MediaTek MT7981B, 512MB RAM
# ============================================

REPO="https://github.com/immortalwrt/immortalwrt.git"
BRANCH="openwrt-23.05"

TARGET="mediatek"
SUBTARGET="filogic"
DEVICE="cmcc_rax3000m"

DESCRIPTION="CMCC RAX3000M eMMC 64GB - MediaTek MT7981B"

PACKAGES=(
    # --- 代理 ---
    +luci-app-homeproxy
    +luci-app-passwall

    # --- 主题 ---
    +luci-theme-argon
    +luci-app-argon-config

    # --- 系统工具 ---
    +luci-app-ttyd
    +luci-app-netdata
    +luci-app-frpc
    +luci-app-upnp

    # --- 网络诊断 ---
    +tcpdump
    +curl
    +wget-ssl
    +ip-full

    # --- 透明代理内核模块 ---
    +kmod-nft-tproxy
    +kmod-nft-socket
    +kmod-nft-fullcone
    +kmod-tun
    +kmod-inet-diag
    +sing-box

    # --- USB 存储 ---
    +block-mount
    +kmod-usb-storage
    +kmod-usb-storage-uas
    +kmod-fs-ext4
    +kmod-fs-ntfs3
    +kmod-fs-vfat

    # --- 去掉 ---
    -luci-app-rclone
    -luci-app-banip
    -luci-app-ramfree
    -luci-app-samba4
)

LANG="zh-cn"
SINGBOX_FEATURES=(ACME ECH GVISOR QUIC REALITY_SERVER UTLS WIREGUARD)
PASSWALL_INCLUDE=(Haproxy Shadowsocks_Rust_Client Shadowsocks_Rust_Server Simple_Obfs SingBox V2ray_Geoview V2ray_Plugin Xray)
